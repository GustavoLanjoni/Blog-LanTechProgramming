<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criar Postagem - Blog</title>
    <link rel="stylesheet" href="css/post.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>

    <main class="post-form-container">
        <form id="createPostForm" enctype="multipart/form-data">
            <label for="postTitle">Título da Postagem</label>
            <input type="text" id="postTitle" name="postTitle" placeholder="Digite o título da postagem" required>

            <label for="postImage">Imagem de Capa</label>
            <input type="file" id="postImage" name="postImage" accept="image/*" onchange="previewImage()" required>

            <div id="imagePreviewContainer" class="image-preview-container">
                <img id="imagePreview" alt="Pré-visualização da imagem" style="display: none;">
            </div>

            <label for="postCategory">Categoria</label>
            <select id="postCategory" name="postCategory" required>
                <option value="" disabled selected>Selecione a categoria</option>
                <option value="destaque-da-semana">Destaque da Semana</option>
                <option value="tecnologia">Tecnologia e Entretenimento</option>
                <option value="mundo">Mundo</option>
            </select>

            <label for="postSubtitle">Subtítulo</label>
            <input type="text" id="postSubtitle" name="postSubtitle" placeholder="Digite o subtítulo da postagem" required>

            <label for="postContent">Conteúdo Completo</label>
            <textarea id="postContent" name="postContent" rows="8" placeholder="Digite o conteúdo completo do post..." required></textarea>

            <button type="submit">Publicar Postagem</button>
        </form>
    </main>

    <footer>
        <p>&copy; 2025 Blog. Todos os direitos reservados.</p>
    </footer>

    <script>
        function previewImage() {
            const file = document.getElementById("postImage").files[0];
            const reader = new FileReader();

            reader.onloadend = function () {
                const preview = document.getElementById("imagePreview");
                preview.src = reader.result;
                preview.style.display = "block";
                preview.style.width = "250px";
                preview.style.height = "250px";
                preview.style.objectFit = "cover";
            }

            if (file) {
                reader.readAsDataURL(file);
            }
        }

        document.getElementById("createPostForm").addEventListener("submit", async function (event) {
            event.preventDefault();

            const formData = new FormData(this);
            const response = await fetch("http://localhost:3000/posts", {
                method: "POST",
                body: formData
            });

            if (response.ok) {
                alert("Postagem criada com sucesso!");
                this.reset();
                document.getElementById("imagePreview").style.display = "none";
            } else {
                alert("Erro ao criar postagem.");
            }
        });
    </script>

</body>

</html>
